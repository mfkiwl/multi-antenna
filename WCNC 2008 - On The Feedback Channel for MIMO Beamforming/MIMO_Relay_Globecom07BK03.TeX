
\documentclass[10pt,fleqn, twocolumn]{IEEEtran}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{fancyhdr}


\newtheorem{Prop}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}

\setlength{\parindent}{3em} \setlength{\oddsidemargin}{0in}
\setlength{\textwidth}{6.5in} % sets 1in left and right margins
\setlength{\topmargin}{0.20in} % change to 0.2in for regular latex
%\setlength{\headheight}{0in}
%\setlength{\footheight}{0.5in}
\setlength{\footskip}{0.5in}
\setlength{\textheight}{9.0in} %sets 1in top and bottom margins
\renewcommand{\baselinestretch}{1} %set to 1.5 for double spacing.

\newcommand{\br}{{\mathbf r}}
\newcommand{\bA}{{\mathbf A}}
\newcommand{\ba}{{\bf a}}
\newcommand{\bb}{{\bf b}}
\newcommand{\bc}{{\bf c}}
\newcommand{\bC}{{\bf C}}
\newcommand{\bd}{{\bf d}}
\newcommand{\be}{{\bf e}}
\newcommand{\bE}{{\bf E}}
\newcommand{\bbf}{{\bf f}}
\newcommand{\bF}{{\bf F}}
\newcommand{\bh}{{\bf h}}
\newcommand{\bH}{{\bf H}}
\newcommand{\bg}{{\bf g}}
\newcommand{\bG}{{\bf G}}
\newcommand{\bq}{{\bf q}}
\newcommand{\bs}{{\bf s}}
\newcommand{\bm}{{\bf m}}
\newcommand{\bn}{{\bf n}}
\newcommand{\bu}{{\bf u}}
\newcommand{\bv}{{\bf v}}
\newcommand{\bw}{{\bf w}}
\newcommand{\bx}{{\bf x}}
\newcommand{\by}{{\bf y}}
\newcommand{\bz}{{\bf z}}
\newcommand{\bL}{{\bf L}}
\newcommand{\bM}{{\bf M}}
\newcommand{\bN}{{\bf N}}
\newcommand{\bS}{{\bf S}}
\newcommand{\bT}{{\bf T}}
\newcommand{\bD}{{\bf D}}
\newcommand{\bX}{{\bf X}}
\newcommand{\bP}{{\bf P}}
\newcommand{\bQ}{{\bf Q}}
\newcommand{\bI}{{\bf I}}
\newcommand{\bR}{{\bf R}}
\newcommand{\bU}{{\bf U}}
\newcommand{\bV}{{\bf V}}
\newcommand{\bW}{{\bf W}}
\newcommand{\bY}{{\bf Y}}
\newcommand{\bZ}{{\bf Z}}
\newcommand{\bJ}{{\bf J}}
\newcommand{\bB}{{\bf B}}
\newcommand{\bzero}{{\bf 0}}
\newcommand{\bgamma}{{\mbox {\boldmath $\gamma$}}}
\newcommand{\btheta}{{\mbox {\boldmath $\theta$}}}
\newcommand{\bvartheta}{{\mbox {\boldmath $\vartheta$}}}
\newcommand{\bDelta}{{\mbox {\boldmath $\Delta$}}}
\newcommand{\bLambda}{{\mbox {\boldmath $\Lambda$}}}
\newcommand{\bPsi}{{\mbox {\boldmath $\Psi$}}}
\newcommand{\bPhi}{{\mbox {\boldmath $\Phi$}}}
\newcommand{\bcA}{{\mbox {\boldmath ${\cal A}$}}}
\newcommand{\bcB}{{\mbox {\boldmath ${\cal B}$}}}
\newcommand{\bcC}{{\mbox {\boldmath ${\cal C}$}}}
\newcommand{\bcD}{{\mbox {\boldmath ${\cal D}$}}}
\newcommand{\bcF}{{\mbox {\boldmath ${\cal F}$}}}
\newcommand{\bcG}{{\mbox {\boldmath ${\cal G}$}}}
\newcommand{\bcL}{{\mbox {\boldmath ${\cal L}$}}}
\newcommand{\bcN}{{\mbox {\boldmath ${\cal N}$}}}
\newcommand{\bcR}{{\mbox {\boldmath ${\cal R}$}}}
\newcommand{\bcS}{{\mbox {\boldmath ${\cal S}$}}}
\newcommand{\bcH}{{\mbox {\boldmath ${\cal H}$}}}
\newcommand{\bcI}{{\mbox {\boldmath ${\cal I}$}}}
\newcommand{\bcO}{{\mbox {\boldmath ${\cal O}$}}}
\newcommand{\bcP}{{\mbox {\boldmath ${\cal P}$}}}
\newcommand{\bcQ}{{\mbox {\boldmath ${\cal Q}$}}}
\newcommand{\bcV}{{\mbox {\boldmath ${\cal V}$}}}
\newcommand{\bcW}{{\mbox {\boldmath ${\cal W}$}}}


\title{MIMO Beamforming with Finite-Rate Feedback and Imperfect Channel Estimation}
\author{LGE Mobile Research\\San Diego, CA 92131}
\date{}
\begin{document}
\maketitle
\begin{abstract}\small
We investigate the effects of finite-rate feedback and imperfect
channel estimation on the end-to-end throughput of multi-antenna
relay network in this paper. We start from multi-antenna
beamforming transmission with uniform random codebook and
formulate SNR loss due to channel quantization and estimation. We
then extend our analysis to MIMO relay network with multiple relay
nodes and discuss how the relay channel capacity is scaled by MIMO
pilot channel size, codebook size and the number of relays.
Computer simulations are also provided to support our results.
\end{abstract}

\section{Introduction}
Multi-antenna systems have received much attention for the past
decade or so, due to their promise of higher spectrum efficiency
with no transmit power increase. Combining wireless relay with
multi-antenna transceiver is essential not only to provide
comprehensive coverage but also to help relieve co-channel
interference in existing wireless systems. For multiple-input
multiple-output (MIMO) transmission, it is well-known that their
performance and complexity can be improved by making channel state
information (CSI) available at the transmitter. This is usually
achieved through a special reverselink CSI feedback channel from
receiver. For example, there is R-CQI channel for the 4G networks
UMB (Ultra Mobile Broadband). In practice, the CSI received by the
transmitter is imperfect and suffers from various impairments and
limitations, which include round-trip delay, channel estimation
errors, limited codebook, etc. Therefore the actual link
throughput is usually degraded. This kind of loss may be more
serious if the end-to-end capacity is considered for a multi-hop
MIMO relay network.

Multi-antenna systems with quantized feedback have intensively
been investigated since 1990s~\cite{Gerlach94}. MIMO channel
quantization as well as codebook design in general is a Voronoi
decomposition problem, which is NP-hard. The Voronoi region for a
uniformly random codebook is known to be upper-bounded by the
disk-covering problem solution and lower-bounded by the
sphere-packing problem solution. Both of these two problems are
still open too. Optimal quantization and feedback for
multi-antenna system is studied in~\cite{Lau04}. The MISO/MIMO
system with perfect CQI and Lloyd vector quantization (VQ) was
investigated in~\cite{Narula98,PXia04,Roh04} and with Rayleigh
fading channels in~\cite{Mukka03}. It is linked to Grassmannian
line packing problem by~\cite{Love02}. Lloyd VQ for MIMO codebook
design was investigated in~\cite{PXia04,Roh04} with different
performance metrics. Most of existing research is done with the
assumption of perfect channel knowledge, even though it is not
true in practice. In reality, MIMO CSI is estimated using
forward-link common pilot channels sent by transmitter. An
overview of pilot-assisted transmission (PAT) can be found
in~\cite{Tong04}. Most existing pilot design are orthogonal design
where pilot symbols are periodically sent by transmitter within
either separated symbols or subcarriers. Optimal orthogonal pilot
placement is discussed in~\cite{Dong02}. Besides conventional
pilot design by TDM, CDM and OFDM, superimposed pilots (SIP) have
recently received much attention for MIMO channel
estimation~\cite{Coldrey06}. In practice, it is desirable to
understand how to balance MIMO pilot size and codebook size and
both of them are key parameters of multi-antenna systems. And this
problem becomes more critical when a multi-hop MIMO relay network
with finite-rate feedback is considered.

It is known that there is no general solution to optimal MIMO
quantization. In this paper, a heuristic Voronoi boundary is
presented using Hamming bound. It is shown that this heuristic
boundary is also bounded by disk-covering circle and
sphere-packing boundary and they are asymptotically converged
together. For MIMO CSI estimation, both TDM pilots (TMP) and SIP
are considered and the Cramer-Rao lower bound (CRLB) is presented
for channel estimation. After this,

\section{MIMO Link Model And Problem Description\label{MIMO_system_model}}

Consider a MIMO link consisting of a transmitter with $M$ transmit
antennas, a receiver with $N$ receive antenna and a MIMO channel
represented by the $N\times M$ matrix $\bH=\left[\bh_{1}\ \bh_{2}\
\ldots\ \bh_{M}\right]$ with $\bh_{m}=\left[h_{1,m}\ h_{2,m}\
\ldots\ h_{N,m}\right]^{\rm T}$ . The $N\times 1$ received signal
$\by$ is
\begin{equation}
\begin{array}{rcl}
\by& = & \bH\bW\bx+\bn
\end{array}\label{Direct_MIMO}
\end{equation}
\noindent where $\bx$ is the transmitted $M\times 1$ signal vector
by the source with $\bR_{\bx}=\mbox{E}\left\{\bx\bx^{\rm
H}\right\}=\frac{P}{M}\bI_{M}$, where $\left[\ast\right]^{\rm H}$
is the Hermitian conjugate operation and $P$ is the total
transmission power, $\bW=\left[\bw_{1}\ \bw_{2}\ \ldots\
\bw_{M}\right]$ is a $M\times M$ MIMO linear beamforming matrix
with each codeword satisfying $\left\|\bw_{m}\right\|_2=1$, and
$\bn\sim{\bcC\bcN}(0, \sigma^2\bI_{N})$ is a complex circular
white Gaussian vector. It is known that the achievable MIMO
channel efficiency is
\begin{equation}%\hspace{-0.2in}
\begin{array}{rcl}
\eta &=& \log\left|\bI_{N}+\frac{P}{M}\bH\bW\bW^{\rm H}\bH^{\rm
H}\right|\\
& =& \sum\limits_{k=1}^{K}\log\left(1+\frac{\rho_{i}}{M}\right)
\end{array}\label{spectral_eff}
\end{equation}
\noindent where $\rho_{i}$ denotes the received signal-to-noise
ratio (SNR) of the $k$th beam, which is given by
\begin{equation}
\begin{array}{rcccl}
\rho_{i}&=&\frac{\mbox{var}\left\{\bH\bw_{i}x_{i}\right\}}{\sigma^2}&=&\frac{\lambda_{i}P_{i}}{\sigma^2}
\end{array}\label{SNR_i}
\end{equation}
\noindent with $\lambda_{i}$ the antenna gain for the $i$th beam
and also the $i$th eigenvalue of the MIMO channel autocorrelation
matrix $\bR_{\bH}$ defined by
\begin{equation}
\begin{array}{rcccl}
\bR_{\bH}&=&\bH\bH^{\rm
H}&=&\sum\limits_{m=1}^{M}\bh_{m}\bh_{m}^{\rm H}
\end{array},\label{R_h}
\end{equation}
\noindent $\left|\ast\right|$ denotes the determinant of matrix
$\ast$, and $\mbox{var}\left\{\ast\right\}$ denotes the variance
function of random variable $\ast$. (\ref{spectral_eff}) and
(\ref{SNR_i}) are the results from the assumption of perfect CSI
available at transmitter. However, this may not be the case in
practical applications.

In reality, the receiver estimates channel responses with pilots
sent by transmitter at first. Accuracy of the channel estimator
depends on the pilot design and placement. There are two popular
pilot patterns, time-multiplexed pilots and superimposed pilots,
recently received much attention, which are shown in
Fig.~\ref{pilot_pattern}. based on channel estimation, the
receiver will choose a beamforming vector from the MIMO precoding
codebook which is shared between the receiver and transmitter.
This procedure is called channel quantization. The receiver then
feeds back the chosen precoding index(es) to the transmitter for
the next transmission. The MIMO beamforming codebook $\bcW$ of the
size $2^B$ consists of $M$-dimensional normalized vectors
$\left\{\bw_{1}, ..., \bw_{2^{B}}\right\}$. It usually takes the
receiver $B$ feedback bits for each beamforming stream. The
codebook is usually designed to quantize channel responses with
certain distortion measures~\cite{Narula98}. This procedure is
also related to Grassmannian line packing and spherical packing on
unit sphere $\bcS_{n}\left(1\right)$~\cite{conway96packing}, where
$\bcS_{n}(R)=\left\{\bv:\ \left\|\bv\right\|=R\right\}$ denotes
$(n-1)$-sphere with radius $R$.
\begin{figure}
\center{
\includegraphics[width=3in, angle=0]{Pilot_Patterns.eps}
\caption{Pilot patterns for channel
estimation.}\label{pilot_pattern} }
\end{figure}
If the codeword $\bw_k$ is chosen to precode signals for $i$th
beam at the transmitter side, there is possible degradation on the
signal received by receiver due to finite-rate feedback and
imperfect channel estimation. This degradation can be expressed by
\begin{equation}
\begin{array}{rcl}
\delta_{i} & = & \min\limits_{\bw\in\bcW}\left\|\bH\bv_{i}-\bH\bw_{k}\right\|\\
&=&\lambda_{i}\left(1-\bv_{i}^{\rm
H}\bw_k\right)-\sum\limits_{j\neq i}\lambda_{j}\bv_{j}^{\rm
H}\bw_{k}
\end{array}\label{delta_i}
\end{equation}
\noindent where $\bv_{i}$ denotes the ideal beamforming vector for
eigen-mode $i$ of $\bH$. It is known that $\delta_{i}$ is one of
the major factors limiting closed-loop MIMO throughput.
$\delta_{i}$ is random variable which depends on $\bv_{i}$,
$\bw_{k}$ and $\lambda_{i}$. There are two items in
(\ref{delta_i}). The first term
\begin{equation}
\begin{array}{rcccl}
\Delta&=&\lambda_{i}\left(1-\bv_{i}^{\rm
H}\bw_k\right)&=&\left(1-\alpha_{i}\right)\lambda_{i}
\end{array}
\end{equation}
\noindent denotes the loss of antenna gain, where
\begin{equation}
\begin{array}{rcl}
\alpha_{i}&=&\bv_{i}^{\rm H}\bw_k
\end{array}.\label{alpha}
\end{equation}
\noindent The second terms
\begin{equation}
\begin{array}{rcccl}
I_{} & = & \sum\limits_{j\neq i}\lambda_{j}\bv_{j}^{\rm
H}\bw_{k}&=&\sum\limits_{j\neq i}\alpha_{j}\bw_{k}
\end{array}\label{IBI}
\end{equation}

\noindent denotes the inter-beam interference (IBI) due to the
correlation between the precoding codeword $\bw_{k}$ and other
eigen-modes $j\neq i$. The average received
signal-to-noise/interference ratio (SINR) $\bar\rho_{i}$ for the
$i$th eigen-mode using codeword $\bw_{i}$ can be written by
\begin{equation}
\begin{array}{rcl}
\bar\rho_{i}&=&\mbox{E}_{\bv_{i}\in{\cal
V}_{k}}\left\{\frac{\lambda_{i}\left(\bv_{i}^{\rm
H}\bw_{k}\right)^2P_{i}}{n_{0}^2+ \lambda_{i}\sum\limits_{l\neq
i}^{K}\left(\bv_{i}^{\rm H}\bw_{l}\right)^{2}P_{l}}\right\}\\
&=&\mbox{E}_{\bv_{i}\in{\cal
V}_{k}}\left\{\frac{\alpha_{i}^{2}\rho_{i}}{1+
\lambda_{i}\sum\limits_{l\neq
i}^{K}\frac{\alpha_{l}^{2}}{\lambda_{l}}\rho_{l}}\right\}\ ,
\end{array}
\end{equation}
\noindent where $K\leq\mbox{min}\left\{M,\ N\right\}$ denotes the
number of beams in use.

There are many power allocation strategies for assigning how much
power to each beam. For maximizing MIMO throughput, the so-called
water-filling strategy is used so that $P_{k}$ satisfys
\begin{equation}
\begin{array}{l}
P_{k}=\left(\mu-\frac{\sigma_{n}^2}{\lambda_{k}}\right)^{+}=
\begin{cases}
\mu-\frac{\sigma_{n}^2}{\lambda_{k}} & \mu-\frac{\sigma_{n}^2}{\lambda_{k}} >0 \\
0 & \mu-\frac{\sigma_{n}^2}{\lambda_{k}} < 0
\end{cases}
\end{array}
\end{equation}
with $\mu$ chosen so that the total power constraint is satisfied
\begin{equation}
\begin{array}{rcl}
\sum\limits_{k=1}^{K}P_{k}&=&P
\end{array}.\label{power_constraint}
\end{equation}
\noindent If the delay-limited power allocation strategy is used,
\begin{equation}
\begin{array}{rcl}
P_{k}&=&\frac{\mu}{\lambda_{k}}
\end{array}
\end{equation}
with $\mu$ chosen to satisfy (\ref{power_constraint}). It is also
called channel inversion strategy. A more simple but popular
strategy for allocating power is to assign each beam the average
power
\begin{equation}
\begin{array}{rcl}
P_{k}&=&\frac{P}{K}
\end{array}.\label{P_aver}
\end{equation}
\noindent In the following two sections, the effects of channel
quantization error and imperfect channel estimation on channel
capacity and received SINR will be investigated.

\section{Hamming Bound on Channel Quantization}
\begin{figure}
\center{
\includegraphics[width=3.20in, angle=0]{Voronoi_Bounds.eps}
\caption{Voronoi cell and various bounds}\label{Voronoi_bound} }
\end{figure}
If the Voronoi decomposition of the codebook $\bcW$ is known, the
correlation ratio $\alpha$ defined in (\ref{alpha}) can be decided
However, the closed-form solution to the boundary of a general
Voronoi cell, which is a polytope, still is open-problem even for
a regular Voronoi tessellation. This makes it difficult to give
some insight of the average SNR $\bar{\rho}_{i}$ for the $i$th
eigen-mode. Instead of finding the exact boundary for $\bcV_{i}$,
we suggest a heuristic approach, in which we use a sphere cap to
approximate the bound by Hamming bound so that the interior of the
sphere cap has the same area as the Voronoi cell. This can be
illustrated in Fig.~\ref{Voronoi_bound}. It is known that, for an
uniform random codebook of size $2^{B}$ in $M$-dimensional Euclid
space, the area of a Voronoi cell is given by
\begin{equation}
\begin{array}{rcl}
A\left(\bcV_{k}\right)&=&
\frac{2{\pi}^{M}}{2^{B}\Gamma\left(M\right)}
\end{array}\label{V_area}
\end{equation}
\noindent where $\Gamma\left(\ast\right)$ is the gamma function.
On the other hand, the area of $(m-1)$-complex sphere cap
$\bcC_{m}^{\rm c}\left(\psi,\ R\right)$ with angle $\psi$ and
radius $R$ is
\begin{equation}
\begin{array}{rcl}
A\left(\bcC_{m}^{\rm c}\left(\psi,\
R\right)\right)&=&\Phi_{m}\left(\psi\right)S_{2m}\left(R\right)
\end{array},
\end{equation}
\noindent where $\Phi_{m}\left(\psi\right)$ is defined by
\begin{equation}
\begin{array}{rcl}
\Phi_{m}\left(\psi\right)&=&1-\cos^{(2m-2)}\left(\psi\right)
\end{array}.
\end{equation}
\noindent The examples of sphere and sphere-cap are shown in
Fig.~\ref{Sphere_Cap}. It can be verified that on a area of a
$(m-1)$-complex sphere $S_{m}^{c}\left(R\right)$ with the radius
$R$ is
\begin{equation}
\begin{array}{rcl}
A\left(S_{m}^{c}\left(R\right)\right)&=&A\left(\bcC_{m}^{\rm
c}\left(\pi,\ \bw\right)\right)
\end{array}.
\end{equation}

\begin{figure}
\center{
\includegraphics[width=2.20in, angle=0]{Sphere_Cap.eps}
\caption{Sphere and sphere cap}\label{Sphere_Cap} }
\end{figure}

\noindent Now the boundary of a Voronoi cell can be approximated
by a hypershpere or a closed space curve decided in the following
proposition.
\begin{Prop}\label{approx_bound}(Hamming Bound) The boundary of the uniform complex Voronoi cell $\bcV_{k}$ can be
approximated by a $(M-1)$-unit complex sphere or a closed complex
space curve.
\begin{equation}\hspace{-0.05in}
\begin{array}{rcl}
\bB\left(\bcV_{k}\right)&\approx& \bcS_{M}^{\rm c}(1)\bigcap \bcL_{M}^{\rm c}(\bw_{k},\ \cos(\theta)) \\
&=&\left\{\bv:\ \left\|\bv\right\|=1,\ \angle\left(\bv,\
\bw_{k}\right)=\theta\right\}\ ,
\end{array}
\end{equation}
\noindent where ${\bcS}_{M}^{\rm c}\left(R\right)$ denotes a
$M$-dimension complex ball in Euclid space with the radius $R$ and
$\bcL_{M}^{\rm c}\left(\bw_{k},\ \cos(\theta)\right)=\left\{\bv:\
\bv^{\rm H}\bw_{k}=\cos(\theta)\right\}$ denotes a complex space
curve and $\theta$ is
\begin{equation}%\hspace{-0.00in}
\begin{array}{rcl}
\theta&=&\arccos\left(\alpha_{0}\right)
\end{array}
\end{equation}
\noindent with
\begin{equation}\hspace{-0.00in}
\begin{array}{rcl}
\alpha_{0}&=&\left(\frac{2^B-1}{2^B}\right)^{\frac{1}{2M-2}}
\end{array}
\end{equation}
\noindent denoting the maximum antenna gain loss ratio.
\end{Prop}

On the other hand, it is known that the probability density
function (PDF) $\mbox{pr}\left(\alpha\right)$ and the cumulated
density function (CDF) $\mbox{Pr}\left(\alpha\right)$ of $\alpha$
are
\begin{equation}\hspace{-0.10in}
\begin{array}{rcl}
\mbox{pr}\left(\alpha\right)&=&\mbox{Prob}\left\{x=\alpha\right\}\\
&=&\begin{cases}
0 & 0\leq \alpha < \alpha_{0} \\
\frac{\left(2M-2\right)\alpha\left(1-\alpha^2\right)^{M-2}}{\left(1-\alpha_{0}^{2}\right)^{M-1}}
& \alpha_{0}\leq\alpha\leq 1
\end{cases}
\end{array}
\end{equation}
\noindent and
\begin{equation}\hspace{-0.10in}
\begin{array}{rcl}
\mbox{Pr}\left(\alpha\right)&=&\mbox{Prob}\left\{x\leq\alpha\right\} \\
&=&
\begin{cases}
0 & 0 \leq\alpha < \alpha_{0} \\
1-\left(\frac{1-\alpha^2}{1-\alpha_{0}^2}\right)^{M-1} &
\alpha_{0}\leq\alpha\leq 1
\end{cases}\ .
\end{array}
\end{equation}

With the assumption of uniform random codebook and beam-power
distribution, the average received SINR $\bar\rho_{i}$ can be
lower-bounded by the following conclusion.
\begin{lemma} A heuristic bound of the mean of $\rho_{i}$
can be expressed by
\begin{equation}%\hspace{-0.10in}
\begin{array}{rcl}
\bar\rho_{i}&\gtrsim& \frac{\sigma_{\alpha}^{2}\rho_{i}}{1+
\left(\frac{1-\sigma_{\alpha}}{M-1}\right)^{2}\sum\limits_{j\neq
i}\frac{\lambda_{i}}{\lambda_{j}}\rho_{j}}\ ,
\end{array}
\end{equation}
\noindent where  $\sigma_{\alpha}$ denotes the standard deviation
of $\alpha$ and $\sigma_{\alpha}^2$ is given by
\begin{equation}
\begin{array}{rcl}
\sigma_{\alpha}^2&=&\mbox{E}\left\{\alpha_{i}^2\right\}\\
&=&\int\limits_{1}^{\alpha_{0}}\frac{\left(2M-2\right)\alpha^3\left(1-\alpha^2\right)^{M-2}}{\left(1-\alpha_{0}^{2}\right)^{M-1}}d\alpha\\
&=&\frac{1}{M}+\frac{M-1}{M}\alpha_{0}^2\ .
\end{array}
\end{equation}
\end{lemma}

\section{Cramer-Rao Bound on Channel Estimation}
The MIMO channel model presented in Section
\ref{MIMO_system_model} is symbol-based without considering
inter-symbol interference (ISI). In general, the channel
estimation model for frequency-selective block fading channel is
different to (\ref{Direct_MIMO}). It shall consider not only the
time-domain spreading of channel impulse response but also the
pilot placement. Consider $M$-input and $N$-output channels. The
channels are assumed to be frequency-selective block fading, which
means the random channels taps remain constant for some data
packets and change to independent values for the next. The
baseband received signal can be written as:
\begin{equation}\hspace{-0.20in}
\begin{array}{rcl}
\by(t)&=&\left[\begin{matrix}y_{1}(t)&y_{2}(t)&\cdots&y_{N}(t)\end{matrix}\right]^{\rm T}\\
&=&\left[\begin{matrix}\sum\limits_{m=1}^{M}h_{m,1}(t)\otimes s_m(t)\\ \sum\limits_{m=1}^{M}h_{m,2}(t)\otimes s_m(t)\\ \vdots \\
\sum\limits_{m=1}^{M}h_{m,N}(t)\otimes
s_m(t)\end{matrix}\right]+\bn\\
&=&\left[\begin{matrix}\bh_{1}^{\rm T}(t)\otimes \bs(t)\\ \bh_{2}^{\rm T}(t)\otimes \bs(t)\\ \vdots \\
\bh_{N}^{\rm T}(t)\otimes \bs(t)\end{matrix}\right]+\bn\ ,
% &=&\bH(t)\otimes\bs(t)+\bn \\
\end{array}
\end{equation}
\noindent where $\bh_{m}(l)=\left[h_{1,m}(l)\ h_{2,m}(l)\ \ldots\
h_{N,m}(l)\right]^{\rm T}$ for $1\leq l \leq L_{c}$ is the channel
impulse response vector from the $M$ transmit antennas to the
$n$th receive antenna and $L_{c}$ is the maximum channel order for
all $N$ subchannels. $s_m(t)$ denotes the transmitted symbol from
the $m$th antenna and $n$ represents the independent additive
Gaussian white noise. Due to the commutativity of convolution, the
stretched discrete received signal vector could as well be
expressed by the following expression
\begin{equation}%\hspace{-0.00in}
\begin{array}{rcl}
\by&=&\bS\bh+\bn
\end{array},
\end{equation}
\noindent where $\bh$ is the stretched channel vector defined by
\begin{equation}\hspace{-0.00in}
\begin{array}{rcl}
\bh&=&\mbox{vec}\left(\left[\mbox{vec}(\bH_{1})\
\mbox{vec}(\bH_{2})\ \ldots\ \mbox{vec}(\bH_{M})\right]\right)
\end{array}
\end{equation}
\noindent with $\bH_{k}=\left[\bh_{k}(0)\ \bh_{k}(1)\ \ldots\
\bh_{k}(L_{c}-1)\right]$ and
\begin{equation}\hspace{-0.00in}
\begin{array}{rcl}
\bS&=&\mbox{kron}\left(\left[\bS_{1}\ \bS_{2}\ \ldots\
\bS_{M}\right]^{\rm T},\ \bI\right)
\end{array}
\end{equation}
\noindent with
\begin{equation}\hspace{-0.10in}
\begin{array}{rcl}
\bS_{k}&=&\left[\begin{matrix}
s_{k}(L)&\cdots&s_{k}(L-L_{c})\\
s_{k}(L-1)&\cdots&s_{k}(L-L_{c}-1)\\
\vdots&\ddots&\vdots\\
s_{k}(1)&\cdots&s_{k}(1-L_{c})
\end{matrix}\right]
\end{array}.\label{S_k}
\end{equation}
After the channel response vector $\bh$ is estimated, we can
calculate the channel correlation matrix $\bR_{\bH}$ by
\begin{equation}\hspace{-0.1in}
\begin{array}{rcl}
\hat{\bR}_{\bH}&=&\frac{1}{L_{c}}\sum\limits_{l=1}^{L_{c}}\sum\limits_{m=1}^{M}\bh_{m}\left(L_{c}+l\right)\bh_{m}^{\rm
H}\left(L_{c}+l\right)
\end{array}\label{R_h_actual}
\end{equation}
\noindent There are many ways to put pilot symbols and data
symbols together. Here we will focus on two most popular designs:
(i) {\em orthogonal design}, {time-multiplexed pilot pattern}, and
(ii) {\em non-orthogonal design}, {superimposed pilot pattern}.
\subsubsection{Time-Multiplexed Pilots and Data}
The concept of TMP design is to send $Q$ known pilot symbols
first, which is followed by $D$ data symbols. It is shown in
Fig.~\ref{pilot_pattern}(a). At this time, the transmitted symbol
$s_{k}(l)$ defined in (\ref{S_k}) becomes
\begin{equation}
\begin{array}{rcl}
s_{k}\left(l\right)&=&
\begin{cases}
s_{pk}(l) & 1 \leq l \leq Q \\
s_{dk}(l-Q) & Q+1\leq l\leq L
\end{cases}
\end{array},\label{TMP_k}
\end{equation}
\noindent where $s_{pk}(t)$, $1\leq t \leq Q$, denotes the pilot
symbols transmitted in power $\sigma_{p}^2$ and $s_{dk}(t)$,
$Q+1\leq t \leq L$, denotes the data symbols transmitted in power
$\sigma_{d}^2$. Since the pilot symbols are transmitted separately
from data symbols in time domain, the channel estimation and data
demodulation usually is done separately at the receiver.
\subsubsection{Superimposed Pilots and Data}
In SIP design, data symbols and pilot symbols are simultaneously
sent within one frame of $L$ symbols. This can be shown in
Fig.~\ref{pilot_pattern}(b). In this case, the transmitted symbol
$s_{k}(l)$ becomes
\begin{equation}
\begin{array}{rcl}
s_{k}\left(l\right)&=&\frac{\sigma_{p}}{P}s_{pk}\left(l\right)+\frac{\sigma_{d}}{P}s_{dk}\left(l\right)\
,\ 1\leq l\leq L\ ,
\end{array}\label{SIP_k}
\end{equation}
\noindent with $\sigma_{p}^2+\sigma_{d}^2=P$.

The lower bound to the mean-squared errors (MSE) of unbiased
channel estimates is given by CRLB, which is defined as the
inverse of the Fisher Information Matrix (FIM). If we denotes
$\bvartheta=\left[\bh^{\rm T}\ \bs_{d}^{\rm T}\right]^{\rm T}$,
the complex FIM is given by
\begin{equation}\hspace{-0.10in}
\begin{array}{rcl}
\mbox{F}\left(\bvartheta\right)&=&\mbox{E}\left\{\left[\frac{\partial\ln\mbox{Pr}\left(\by|\vartheta\right)}{{\partial\vartheta}^{\ast}}\right]\left[\frac{\partial\ln\mbox{Pr}\left(\by|\vartheta\right)}{{\partial\vartheta}^{\ast}}\right]^{\rm H}\right\}\\
 &\hspace{-0.90in}=&\hspace{-0.50in}\sigma_{n}^{-2}\left[\begin{matrix}
\mbox{E}\left\{\bS^{\rm
H}\bS\right\}+\rho_{h}^2\bI&\bzero\\
\bzero&\mbox{E}\left\{\bcH^{\rm H}\bcH\right\}+\rho_{s_{d}}^2\bI
\end{matrix}\right]\ ,
\end{array}
\end{equation}
\noindent where
$\rho_{h}^{2}=\mbox{E}\left\{\left|\frac{\partial\ln\mbox{Pr}\left(h\right)}{{\partial
h}^{\ast}}\right|^2\right\}$ and
$\rho_{s_{d}}^{2}=\mbox{E}\left\{\left|\frac{\partial\ln\mbox{Pr}\left(s_{d}\right)}{{\partial
s_{d}}^{\ast}}\right|^2\right\}$. Here we combine two well-known
conclusions into the following lemma~\cite{Dong02,Coldrey06}.
\begin{lemma}(Cramer-Rao Lower Bound) For the time-multiplexed pilot and data design defined in
(\ref{TMP_k}), the CRLB of channel estimation is
\begin{equation}
\begin{array}{rcl}
\varepsilon_{h}^{\rm
TMP}&\geq&\left[\rho_{h}^2+Q\rho_{p}^2+\left(L-Q\right)\rho_{d}^2\right]^{-1}
\end{array}\label{CRLB_TMP}
\end{equation}
\noindent and, for the superimposed pilot and data design defined
in (\ref{SIP_k}), the CRLB of channel estimation is
\begin{equation}\
\begin{array}{rcl}
\varepsilon_{h}^{\rm
SIP}&\geq&\left[\rho_{h}^2+L\left(\rho_{p}^2+\rho_{d}^2\right)\right]^{-1}
\end{array}\label{CRLB_SIP}
\end{equation}
\noindent where $\rho_{p}^2=\frac{\sigma_{p}^2}{\sigma_{n}^2}$
denotes the SNR of received pilot signals and
$\rho_{d}^2=\frac{\sigma_{d}^2}{\sigma_{n}^2}$ denotes the SNR of
received data signals.
\end{lemma}
Now if we look back at (\ref{R_h_actual}), with the assumption
that the channel is constant during estimation and independent
from one transmit antenna to another and an optimal channel
estimation is done by receiver, a heuristic view of the MIMO
channel correlation matrix can be written by
\begin{equation}
\begin{array}{rcl}
\hat{\bR}_{\bH}&\approx&\bR_{\bH}+\frac{\varepsilon_{h}^2}{L_{c}}\bI_{M}
\end{array},\label{R_h_approx}
\end{equation}
\noindent where $\varepsilon_{h}$ denotes the MSE of channel
estimates. With (\ref{R_h_approx}), it shows that the channel
estimation error at the receiver side will mostly affect the
accuracy of the eigenvalues estimated by the receiver and
therefore the execution of power allocation strategy, except the
average power allocation defined in (\ref{P_aver}). The MSE of
eigenvalue estimates is bounded by
\begin{equation}
\begin{array}{rcl}
\varepsilon_{\lambda}&\gtrsim&\frac{\varepsilon_{h}}{\sqrt{L_{c}}}
\end{array}.\label{eigenvalue_bound}
\end{equation}
There are two major effects of PAT on MIMO channel throughput.
This first one is pilots will take away channel resources from
data transmission.  If orthogonal pilot pattern is used, there are
will be linearly degradation on channel throughput so that
\begin{equation}%\hspace{-0.2in}
\begin{array}{rcl}
\eta^{\rm OT}& =&\frac{L-Q}{L}
\sum\limits_{k=1}^{K}\log\left(1+\frac{\hat{\rho}_{i}}{M}\right)
\end{array},\label{spectral_eff_OT}
\end{equation}
\noindent where $\hat{\rho}_{i}$ denotes the suboptimal power
allocation due to channel estimation error. If superimposed pilot
pattern is employed, the MIMO throughput will become
\begin{equation}%\hspace{-0.2in}
\begin{array}{rcl}
\eta^{\rm
SI}&=&\sum\limits_{k=1}^{K}\log\left(1+\frac{\sigma_{d}^{2}}{P}\frac{\hat{\rho}_{i}}{M}\right)
\end{array}.\label{spectral_eff_OT}
\end{equation}
\section{MIMO Relay Using Beamforming}
\section{Conclusions}

\small
\bibliographystyle{unsrt}
\bibliography{Cooperative_Relay}
\end{document}
